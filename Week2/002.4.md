# Setting up Models and Adapters

In the last drip we set up some components and actions in our contact-manager Ember application. We are going to continue working on that app today by discussing and setting up a Contact model and an adapter that will help us connect our Ember app to a server.

## Setup

You should have a server application running locally on port 4000. I have these two that you can clone and setup if you need.

* [Node/Express Server](https://github.com/baroquon/contact_manager_backend_node)
* [Elixir/Phoenix Server](https://github.com/baroquon/contact_manager_backend)

Both of the servers listed above are serving [JSON API](http://jsonapi.org/) compliant payloads. The Node/Express server will create a few records for you, if you are running the Elixir/Phoenix server you'll need to add a few records before we get started. To do that just go to your terminal and post with some curl commands.

```sh
curl -X POST -H "Content-Type: application/json" -d '{ "contact": { "first_name": "Gerald", "last_name": "Madison", "email":"germader@gmail.com", "phone": "205.555.0438" } }' http://localhost:4000/contacts
curl -X POST -H "Content-Type: application/json" -d '{ "contact": { "first_name": "Jimmy", "last_name": "Jefferson", "email":"jeffster@gmail.com", "phone": "205.555.0339" } }' http://localhost:4000/contacts
curl -X POST -H "Content-Type: application/json" -d '{ "contact": { "first_name": "Ronald", "last_name": "Adams", "email":"radams@gmail.com", "phone": "205.555.0240" } }' http://localhost:4000/contacts
curl -X POST -H "Content-Type: application/json" -d '{ "contact": { "first_name": "Bill", "last_name": "Washington", "email":"washb@gmail.com", "phone": "205.555.0141" } }' http://localhost:4000/contacts
```

Now that we have all that set up, we can get to the Ember stuff.

## The Ember Stuff

The first thing we are going to want to do is let Ember Data handle our data instead of manually creating an array and a couple of objects in the route. Let's go ahead and create a model for our contacts.

```sh
cd /path/to/ember/project
$ ember g model contact firstName:string lastName:string email:string phone:string
```

Our newly generated model at `app/models/contact.js` looks like this:

```JavaScript
import Model from 'ember-data/model';
import attr from 'ember-data/attr';
// import { belongsTo, hasMany } from 'ember-data/relationships';

export default Model.extend({
  firstName: attr('string'),
  lastName: attr('string'),
  email: attr('string'),
  phone: attr('string')
});
```
Here all of our attributes are strings. By default Ember Data gives us four types: string, number, boolean and date. We can also [define our own transforms](http://emberjs.com/api/data/classes/DS.Transform.html). As you can tell from Ember's commented out line above, you can also specify relationships here.

Let's revisit something we looked at briefly earlier: computed properties. Let's add a fullName computed property to our model. In our models we have to remember to import Ember if we want to use Ember's methods like `computed`.

```JavaScript
import Model from 'ember-data/model';
import attr from 'ember-data/attr';
import Ember from 'ember';
// import { belongsTo, hasMany } from 'ember-data/relationships';

export default Model.extend({
  firstName: attr('string'),
  lastName: attr('string'),
  email: attr('string'),
  phone: attr('string'),

  fullName: Ember.computed('firstName', 'lastName', function() {
    return `${this.get('firstName')}  ${this.get('lastName')}`;
  })
});
```
It is also worth nothing that you can also set (computed properties)[https://guides.emberjs.com/v2.6.0/object-model/computed-properties/#toc_setting-computed-properties].

    video only: I'll link to the Ember guides about this in the notes.

To use our model's new computed property we would call it in our template in exactly the same way we would call any other properties on our model. `{{model.fullName}}`

Now we need to update the model hook in our contacts route to pull from Ember Data.

```JavaScript
model(){
  return this.store.findAll('contact');
}
```

If you have one of our server apps running locally at port 4000, there should only be one more step you need to take to wire up the Ember app. We just need to tell it where to look for its data. We do this by generating an adapter.

```sh
$ ember g adapter application
```

Your newly generated adapter at `app/adapters/application.js` looks like this:

```JavaScript
import JSONAPIAdapter from 'ember-data/adapters/json-api';

export default JSONAPIAdapter.extend({
});
```

We should change it to include a host property:

```JavaScript
import JSONAPIAdapter from 'ember-data/adapters/json-api';

export default JSONAPIAdapter.extend({
  host: 'http://localhost:4000'
});
```

There are several methods and properties that you can customize on the JSONAPIAdapter class. The host, headers, and namespace properties are likely the one's that you will most often find yourself needing to customize.

```JavaScript
// if our api is namespaced we would specify that here
namespace: 'api/v2',
headers: {
  "SOME_KEY": "some value"
}
```

Now, if we run our Ember app and visit [http://localhost:4200/contacts](http://localhost:4200/contacts) we will see a list of our contacts.

## Resources

* (Setting computed properties)[https://guides.emberjs.com/v2.6.0/object-model/computed-properties/#toc_setting-computed-properties]
* (JSONAPIAdapter Class)[http://emberjs.com/api/data/classes/DS.JSONAPIAdapter.html]
