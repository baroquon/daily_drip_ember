# Updating Data in a Service

This week we have created a very basic service that we have injected into a single component and used an initializer to inject into all of our controllers, routes, and models. Today we are going to look at modifying data on a service by way of an action which will call a method on the service.

In our contrived example here, let's say that our current-user can send a total of 10 emails. We want to store a count of the remailingEmails on our current-user service.

In `app/services/current-user.js` add an messagesRemaining property and we will set it to `10`. Let's also add a function to decrement the messagesRemaining count.


```JavaScript
import Ember from 'ember';

export default Ember.Service.extend({
  messagesRemaining: 10,
  userInfo: Ember.Object.create({
    id: 1,
    firstName: 'Brandon',
    lastName: 'Blaylock',
    email: 'brandon.blaylock@gmail.com',
    twitter: 'baroquon',
    github: 'baroquon',
  }),
  decrementMessagesRemaining(){
    if(this.get('messagesRemaining') > 0){
      this.decrementProperty('messagesRemaining');
      return { success: true, message: `You have ${this.get('messagesRemaining')} messages remaining.` };
    } else {
      return { success: false, message: `You are out of messages.` };
    }
  }
});
```

We can call this from our component by adding an action on the component that calls this function. So, let's create a message block component that has a textarea that takes in a message and has a button to send the message.

```sh
ember g component send-message
```

In `app/templates/components/send-message.hbs`

```hbs
{{notice}}
<br>
{{textarea value=messageText}}
<button {{action 'sendMessage' messageText}}>Send Message</button>
```

In `app/components/send-message.js`:

```JavaScript
currentUser: Ember.inject.service(),
actions: {
  sendMessage(messageText){
    if(Ember.isPresent(messageText)){
      let sendMessage = this.get('currentUser').decrementMessagesRemaining();
      if(sendMessage.success){
        this.set('messageText', '');
      }
      this.set('notice', sendMessage.message);
    } else {
      this.set('notice', 'You should really type a message before you send one.');
    }

  }
}
```
Finally, let's add our new component to our application template:

```hb
{{send-message}}
```

Now, if we look at our site, we can see our message textarea. We can send a message and we get a notice of how many messages we have remaining, if we try to send a message without text we will get a notice that we can't do that because we used Ember's `isPresent` helper. Finally, if we have sent all of our messages we will receive a notice that we don't have any messages left to send.

That is it for today. Tomorrow we will look at get some links and an exercise to allow us to build on our work. See you then.
