# Thursday

Yesterday we installed the Ember Inspector. It will help us better debug and understand our Ember application. Today, let's try and put it to use by learning a bit about routes, controllers, and components. We are going to do this by building a very basic contact management application.

Lets get started by creating a new Ember project.

    ember new contact-manager
    cd contact-manager

The first thing we should do is to create a route for our contacts. This is a good opportunity to look at some of the generators that Ember CLI gives us.

    ember generate --help

As you can see, there are a lot of options available to us, but right now we are only concered with the route generator.

    ember g route contacts

This command creates three files for us and modifies a fourth. Let's quickly look at what we have. First, the router.js file has been modified. We now have this line:

    this.route('contacts');

This line maps the URL to our route that we just created. So, now the route, located in app/routes/contacts.js should look like this:


    import Ember from 'ember';

    export default Ember.Route.extend({
    });

The template contacts only an empty outlet:

    {{outlet}}

The last file that the generator creates for us is `tests/unit/routes/contacts-test.js`. We will look at testing our Ember application later, but the generated file contains a very basic test that asserts the existance of the route that we just generated. If we start our server and visit [http://localhost:4200/contacts](http://localhost:4200/contacts) right now, it would work and we shouldn't get any errors, actually, we wont get anything. In our template, let's just add a header so we can see that everything is rendering. Let's add a header above the `{{outlet}}`:

    <h2>Contacts</h2>
    {{outlet}}

Now we have something showing up, but it isn't very interesting. To get something interesting and learn a bit about how routes and controllers work together, let's add a model to the route. Normally, we would return something from Ember Data, either an object, or an array of objects, in the route's model hook. Let's save that for later. First, we'll just add a string to the route so we can see how it works:

    export default Ember.Route.extend({
      model(){
        return 'I am from the Route!';
      }
    });

The route's model hook, sets the model on the controller and makes it available in our templates. Now, in our template, we can call the model:
    <h2>Contacts</h2>
    {{model}}
    {{outlet}}

Now, if we look at our site, we get our expected result. Let's replace that string with a more realistic value for a contacts route:


    export default Ember.Route.extend({
      model(){
        let contact1 = { id: 1, firstName: 'Josh', lastName: 'Adams', email: 'josh@dailydrip.com'};
        let contact2 = { id: 2, firstName: 'Adam', lastName: 'Dill', email: 'adam@dailydrip.com'};

        return [contact1, contact2];
      }
    });

Now that we have an array, we will need to iterate over the objects to display their properties. For this we can use Handlebars' `#each` helper. Change the template to:

    <ul>
      {{#each model as |contact|}}
        <li>{{contact.firstName}} {{contact.lastName}}</li>
      {{/each}}
    </ul>

We are going to generate one more route, a child to contacts.

    ember g route contacts/contact

Let's modify a few things, starting the router.js file. Change it to look like this:

    Router.map(function() {
      this.route('contacts', function() {
        this.route('contact', { path: ':contact_id' });
      });
    });

this.route accepts an object as a second paramater with a path key that we can use if we want the path to be different than the route name. In this case, we need a dynamic segment, so we set the path to the contact's id.

Now, lets change the newly created contact template (app/templates/contacts/contact.hbs) to display some information about a single contact rather than an array of contacts. In this case, let's replace the `{{outlet}}` with this:

    {{model.firstName}} {{model.lastName}}
    <br>
    {{model.email}}

The last thing we need to do is pass the object that we want to display to the new route. We will do this by using another helper link-to. Lets add the link-to back in the contacts template.

    <ul>
      {{#each model as |contact|}}
        {{#link-to 'contacts.contact' contact}}
          <li>
            {{contact.firstName}} {{contact.lastName}}
          </li>
        {{/link-to}}
      {{/each}}
    </ul>

There are a couple of things to notice here. First, the link-to: the first part `contacts.contact` is a string representing the route. The second part is the object that we are passing to that route. Also, you may have noticed that we didn't add a model on the contacts/contact route. Since we passed the object into the link-to Ember skips the model hook in the route. It is assumed that we have all the information that we need to render without firing the model hook. If we ever need to force the model hook to fire, we can by passing in the id rather than the object to the link-to:

    {{#link-to 'contacts.contact' contact.id}}

To have a functioning app, you will need an model hook on any route that passes data to a template.

## Notes

Ember is moving away from Controllers and moving towards allowing developers to hook components directly to routes. Presently, controllers in Ember exist as in intermediary for the model which it receives from the associated route, and to handle actions and query params. Soon, they will no longer be neccisary. If you want to read more about that transition you can look over this [RFC:](https://github.com/ef4/rfcs/blob/routeable-components/active/0000-routeable-components.md)
